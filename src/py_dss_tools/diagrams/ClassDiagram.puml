@startuml
'https://plantuml.com/class-diagram

StudyBase <|-- StudySnapShotPowerFlow
StudyBase <|-- StudyShortCircuit
StudyBase <|-- StudyTemporal

StudyBase "1" *-- "1" ModelBase : contains
ElementDataDFs <|-- ModelBase
BusesDataDF <|-- ModelBase
SummaryModelData <|-- ModelBase
ElementData <|-- ModelBase
SegmentsDF <|-- ModelBase
ModelUtils <|-- ModelBase

VoltagesNodal <|-- SnapShotPowerFlowResults
VoltagesElement <|-- SnapShotPowerFlowResults
Currents <|-- SnapShotPowerFlowResults
Powers <|-- SnapShotPowerFlowResults
CircuitSnapShotPowerFlowResults <|-- SnapShotPowerFlowResults

EnergyMeter <|-- TemporalResults
Monitor <|-- TemporalResults
Monitor <|-- ViewTemporalResults

SnapshotPowerFlowResults <|-- Results
TemporalResults <|-- Results
ShortCircuitResults <|-- Results

StudySnapShotPowerFlow "1" *-- "1" SnapShotPowerFlowResults : contains
StudySnapShotPowerFlow "1" *-- "1" StudySnapShotPowerFlowSettings : contains
StudySnapShotPowerFlow "1" *-- "1" DSSViewSnapShotPowerFlowResults : contains
StudySnapShotPowerFlow "1" *-- "1" StaticViewSnapShotPowerFlowResults : contains
StudySnapShotPowerFlow "1" *-- "1" InteractiveViewSnapShotPowerFlowResults : contains

DSSViewSnapShotPowerFlowResults <|-- DSSVoltageProfile
StaticViewSnapShotPowerFlowResults <|-- StaticVoltageProfile
InteractiveViewSnapShotPowerFlowResults <|-- InteractiveVoltageProfile

DSSVoltageProfile <|-- VoltageProfileBase
InteractiveVoltageProfile <|-- VoltageProfileBase
StaticVoltageProfile <|-- VoltageProfileBase

InteractiveCustomPlotStyle "1" *-- "1" InteractiveVoltageProfile : contains
StaticCustomPlotStyle "1" *-- "1" StaticVoltageProfile : contains


StudyShortCircuit "1" *-- "1" ShortCircuitResults : contains

SnapShotPowerFlowResults "1" o-- "1" VoltageProfileBase : contains
SnapShotPowerFlowResults "1" o-- "1" StaticVoltageProfile : contains
SnapShotPowerFlowResults "1" o-- "1" InteractiveVoltageProfile : contains

StudyTemporal "1" *-- "1" TemporalResults : contains
StudyTemporal "1" *-- "1" ViewTemporalResults : contains

'VoltageProfile <|-- ViewSnapShotPowerFlowResults
'ViewSnapShotPowerFlowResults "1" o-- "1" SnapshotPowerFlowResults : contains
'ViewTemporalResults "1" o-- "1" TemporalResults : contains
'
'
'ViewSnapshotPowerFlowResults <|-- ViewResults
'ViewTemporalResults <|-- ViewResults
'ViewResults "1" o-- "1" Results : contains

StudySettings <|-- StudySnapShotPowerFlowSettings

CustomPlotStyle "1" *-- "1" VoltageProfile : contains
SnapshotPowerFlowResults "1" o-- "1" VoltageProfile : contains

class DSSUtils {
    -dss: DSS

    +compile_dss(dss_file: string)
    +solve_snapshot(control_mode: string, max_control_iter: int)
    +dss_command(command: string)
}

class StudyBase {
    +name: string
    +dss: DSS
    +model: ModelBase
}


class StudySnapShotPowerFlow {
    +results: SnapShotPowerFlowResults
    +settings: StudySnapShotPowerFlowSettings
    +dss_view: DSSViewSnapshotPowerFlowResults
    +static_view: StaticViewSnapshotPowerFlowResults
    +interactive_view: InteractiveViewSnapshotPowerFlowResults
    +run()
    -validate_settings()
}

class StudySnapShotPowerFlowSettings {
    +mode: string
    +get_settings()
    -set_dss_number(value: int)
}

class StudySettings {
    +algorithm: string
    +time: Union[List[float], Tuple[float]]
}


class StudyTemporal {
    +view: ViewTemporalResults
    +results: TemporalResults
    +settings: StudyTemporalSettings
}

class ModelBase {
    -dss: DSS
}

class ElementDataDFs {
    -dss: DSS
    +lines_df: pd.DataFrame
    +transformers_df: pd.DataFrame
    +meters_df: pd.DataFrame
    +generators_df: pd.DataFrame
    +vsources_df: pd.DataFrame
    +regcontrols_df: pd.DataFrame
    +loads_df: pd.DataFrame

    -create_dataframe(element: DSS.Element)
}

class BusesDataDF {
    -dss: DSS
    +buses_df: pd.DataFrame

    -create_dataframe()
}

class SummaryModelData {
    -dss: DSS
    +summary_df: pd.DataFrame

    -create_dataframe()
    -get_max_min_norm_amps()
}

class ElementData {
    -dss: DSS
    +element_data(element_class: string, element_name: string): pd.DataFrame
    +edit_element(element_class: string, element_name: string, properties: dict)
    +add_element(element_class: string, element_name: string, properties: dict)
    +add_line_in_vsource(add_meter: Bool)
    -add_meter(meter_name: str, element: str, terminal: int)
    -is_element_in_model(element_class: string, element_name: string)
}

class SegmentsDF {
    -dss: DSS
    +segments_df: pd.DataFrame

    -create_dataframe()
}

class ModelUtils {
    -dss: DSS
    +is_element_in_model(element_class: str, element_name: str): Bool
    +disable_elements_type(element_type: str)
}

class SnapShotPowerFlowResults {
    -dss: DSS
}

class VoltagesNodal {
    -dss: DSS
    +voltage_ln_nodes: Tuple[pd.DataFrame, pd.DataFrame]

    -create_dataframe()
}

class VoltagesElement {
    -dss: DSS
    +voltage_elements: Tuple[pd.DataFrame, pd.DataFrame]

    -create_dataframe()
}

class Currents {
    -dss: DSS
    +currents_elements: Tuple[pd.DataFrame, pd.DataFrame]

    -create_dataframe()
}

class Powers {
    -dss: DSS
    +powers_elements: Tuple[pd.DataFrame, pd.DataFrame]

    -create_dataframe()
}

class CircuitSnapShotPowerFlowResults {
    -dss: DSS
    +circuit_summary: Tuple[pd.DataFrame, pd.DataFrame]

    -create_dataframe()
}


class VoltageProfile {
    -dss: DSS
    -results: SnapshotPowerFlowResults
    + voltage_profile_plot_style: CustomPlotStyle
    + voltage_profile_get_bus_mark()
    + voltage_profile()
}


class DSSVoltageProfile {
    +voltage_profile()

}

class StaticVoltageProfile {
    +voltage_profile_plot_style()
    +voltage_profile_get_bus_marker(name, symbol, size, color, marker_name, show_legend)
    +voltage_profile(title, xlabel, ylabel, xlim, ylim, buses_marker, tight_layout, legend, dpi, save_file_path, show)
}


class InteractiveVoltageProfile {
    +voltage_profile_plot_style()
    +voltage_profile_get_bus_marker(name, symbol, size, color, annotate, marker_name, show_legend)
    +voltage_profile(title, xlabel, ylabel, xlim, ylim, buses_marker, show, save_file_path)
}

class VoltageProfileBase {
    -dss: DSS
    -check_energymeter()
    -prepare_results()

}

@enduml
